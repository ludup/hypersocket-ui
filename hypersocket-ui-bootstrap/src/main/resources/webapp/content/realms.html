<div id="realmsContent" class="col-md-12" style="padding-left: 0px;">

	<div class="modal" id="addRealmForm" tabindex="-1" role="dialog"
		dialog-for="realmsContent">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title"></h4>
				</div>
				<div class="modal-body">
					<div class="dialogError"></div>
					<div class="propertyItem form-group">
						<label class="col-md-3 control-label" localize="realm.name.label"></label>
						<div class="propertyValue col-md-9">
							<input type="text" class="form-control propertyInput"
								placeholder="" id="name" maxlength="" name="name" value="">
							<div>
								<span class="help-block" localize="realm.name.info"></span>
							</div>
						</div>
					</div>
					<div class="propertyItem form-group">
						<label for="type" class="col-md-3 control-label"
							localize="realm.resourceCategory.label"></label> <select
							name="type" id="type" class="">
						</select>
					</div>
					<div id="realmProperties" class=""></div>
					<input name="id" id="id" type="hidden" class="formInput" />

				</div>
				<div class="modal-footer"></div>
			</div>
		</div>
	</div>
</div>
	<script type="text/javascript">
		$(document)
				.ready(
					function() {
						$('#realmsContent').localize();

						$('#type')
								.change(
									function() {
										$('#realmProperties')
												.propertyPage(
													{ url : 'template/realm/' + $(this).val(), showButtons : false, canUpdate : currentMenu.canUpdate, useTemplates : true });
									});

						getJSON(
							'realm/providers',
							null,
							function(data) {
								$
										.each(
											data.resources,
											function() {
												$('#type')
														.append(
															'<option id="realm' + this.module + '" value="' + this.module + '\">' + getResource("realm." + this.module + '.label') + '</option>');
											});

								$('#realmsContent')
										.ajaxResourcePage(
											{ tableUrl : "table/realms", title : getResource('realms.title'), icon : "fa-th", resourceUrl : "realm", fields : [ { name : "name" }, { name : "resourceCategory", isResourceKey : true } ], resourceKey : 'realm', canCreate : currentMenu.canCreate, canUpdate : currentMenu.canUpdate, canDelete : currentMenu.canDelete, validate : function() {
												if ($('#name').val() == '') {
													$('#addRealmForm').dialogError("A name is required!");
													return false;
												}
												return true;
											}, clearDialog : function() {
												$('#name').val("");
												$('#id').val("");
												$('#realmProperties').clearProperties();
											}, createResource : function() {
												realm = new Object();
												realm.name = $('#name').val();
												realm.type = $('#type').val();
												realm.id = $('#id').val();

												$('#realmProperties').saveProperties(true,
													function(items) {
														realm.properties = items;
													});

												return realm;
											}, showCreate : function() {
												$('#type').trigger('change');
											}, displayResource : function(resource) {
												$('#id').val(resource.id);
												$('#name').val(resource.name);
												$('#type').empty();
												$('#type')
														.append(
															'<option id="realm' + resource.resourceCategory + '" value="' + resource.resourceCategory + '\">' + getResource("realm." + resource.resourceCategory + '.label') + '</option>');
												$('#type').attr('disabled', 'disabled');
												$('#realmProperties')
														.propertyPage(
															{ url : 'realm/properties/' + resource.id, showButtons : false, canUpdate : currentMenu.canUpdate });
											}, complete : function() {
												loadComplete();
											}, resourceCreated : function(resource) {
												reloadRealms();
											}, resourceUpdated : function(resource) {
												reloadRealms();
											}, resourceDeleted : function(resource) {
												reloadRealms();
											} });

							});

					});
	</script>