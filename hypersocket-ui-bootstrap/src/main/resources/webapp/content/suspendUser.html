<div class="modal" id="suspendUser" tabindex="-1" role="dialog"
	aria-labelledby="suspendUserModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header lb-modal-header-text-reverse">
				<button type="button" class="close" data-dismiss="modal"
					aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel"></h4>
			</div>
			<div class="modal-body">
				<form class="form" autocomplete="off">
					<input type="hidden" name="token" id="csrfToken" value="${csrf}"/>
					<div class="propertyItem form-group lb-row">
						<label class="col-md-3 control-label" localize="suspendUser.startDate"></label>
						<div class="propertyValue col-md-9">
							<div id="startDate"></div>
							<div>
								<span class="lb-help-block form-text text-muted mt-2 mb-3 pl-1" localize="suspendUser.startDate.info"></span>
							</div>
						</div>
					</div>
					<div class="propertyItem form-group lb-row">
						<label class="col-md-3 control-label" localize="suspendUser.startTime"></label>
						<div class="propertyValue col-md-9">
							<div id="startTime"></div>
							<div>
								<span class="lb-help-block form-text text-muted mt-2 mb-3 pl-1" localize="suspendUser.startTime.info"></span>
							</div>
						</div>
					</div>
					<div class="propertyItem form-group lb-row">
						<label class="col-md-3 control-label" localize="suspendUser.duration"></label>
						<div class="propertyValue col-md-9">
							<div id="duration"></div>
							<div>
								<span class="lb-help-block form-text text-muted mt-2 mb-3 pl-1" localize="suspendUser.duration.info"></span>
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer"></div>
		</div>
	</div>
</div>
<script type="text/javascript">

	function isSuspended(resource) {
		return !resource.suspended;
	}

	legacyjQueryReadyFix(function() {
		$('#suspendUser').localize();
		var date = new Date();
		
		$('#startDate').dateInput({ value: date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate() });
		$('#startTime').timeInput({ value: date.getHours() + ':' + date.getMinutes() + ':' + date.getSeconds() });
		$('#duration').sliderInput({ value: 0,
			min: 0,
			max: 900,
			labelResourceKey: "suspendUser.minutes"
		});

		$('#suspendUser').data('action', function(resource, callback) {
			$('#suspendUser').data('resource', resource);
			$('#suspendUser').data('callback', callback);
			$('#suspendUser').resourceDialog('create');
		});
		
		$('#suspendUser').resourceDialog({
			resourceKey : 'suspendUser',
			resourceUrl : 'currentRealm/suspendUser',
			hasResourceTable : false,
			createResource : function() {
				var user = $('#suspendUser').data('resource');

				resource = new Object();
				resource.principalId = user.id;
				resource.name = user.name;
				resource.duration = $('#duration').data('widget').getValue();
				resource.startDate = new Date($('#startDate').data('widget').getValue() + " " + $('#startTime').data('widget').getValue()); 

				return resource;
			},
			clearDialog : function() {
				$('#startDate').data('widget').reset();
				$('#startTime').data('widget').reset();
				try {
					$('#duration').data('widget').setValue(0);
				}
				catch(e) {
					console.log('FIXME: ' + e);
				}
			},
			validate : function() {
				return true;
			},
			resourceSaved: function() {
				$('#suspendUser').data('callback')();
			}
		});
	}, this);
</script>