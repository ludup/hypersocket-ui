<div id="uninstallPlugin"></div>
<div id="uninstallPluginDialog" class="modal" role="dialog">
	<div class="modal-dialog modal-md">
		<div class="modal-content">
			<div class="modal-header lb-modal-header-text-reverse">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 localize="uninstallPlugin.label"></h4>
			</div>
			<div class="modal-body">
				<div id="uninstallPluginInfo" class="alert alert-warning" localize="uninstallPlugin.info"></div>
				<div id="uninstallDataContainer" class="propertyItem form-group lb-row">
					<label class="col-md-4 control-label"
						localize="uninstallPlugin.uninstallData"></label>
					<div class="propertyValue col-md-8">
						<div id="uninstallData" class="propertyValue"></div>
						<div>
							<span class="lb-help-block form-text text-muted mt-2 mb-3 pl-1"
								localize="uninstallPlugin.uninstallData.info"></span>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal"><i class="far fa-ban"></i><span localize="text.cancel"></span></button>
				<button id="uninstallPluginInstance" type="button" class="btn btn-primary"><i class="far fa-power-off"></i><span localize="uninstallPlugin.uninstall"></span></button>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">

function canUninstall(plugin) {
	return plugin.state === 'RESOLVED' || plugin.state === 'DISABLED' || plugin.state === 'FAILED';
}

legacyjQueryReadyFix(function() {
	
	$('#uninstallPluginDialog').localize();
	$('#uninstallData').empty();
	$('#uninstallData').switchInput({});
	$('#uninstallPluginInstance').click(function(e) {
		startSpin($('#uninstallPluginInstance i'));
		e.preventDefault();
		removeMessage();
		var plugin = $('#uninstallPluginDialog').data('plugin');
		var callback = $('#uninstallPluginDialog').data('callback');
		deleteJSON('plugins/' + ($('#uninstallData').data('widget').getValue() ? 'uninstall' : 'softUninstall')+ '/' + plugin.id, null, function(data) {
			if(data.success) {
				showInformation(data.message);
			} else {
				showError(data.message);
			}
			callback(plugin);
			stopSpin($('#uninstallPluginInstance i'));
			$('#uninstallPluginDialog').modal('hide');
		});
	});
	
	$('#uninstallPlugin').data('action', function(resource, callback) {
		$('#uninstallPluginDialog').data('plugin', resource);
		$('#uninstallPluginDialog').data('callback', callback);
		$('#uninstallPluginDialog').find('h4').text(getResource('uninstallPlugin.title').format(resource.id));
		$('#uninstallPluginDialog').modal('show');
	});
});


</script>