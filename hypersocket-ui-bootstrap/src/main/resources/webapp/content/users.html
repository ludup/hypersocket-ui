<div id="contentExportUsers">
	<form id="csvForm" action="${apiPath}/currentRealm/csv" method="POST" autocomplete="off">
		<div class="modal" id="exportCSVForm" tabindex="-1" role="dialog" dialog-for="contentExportUsers">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-hidden="true">&times;</button>
						<h4 class="modal-title" localize="audit.exportCSV.label"></h4>
					</div>
					<div class="modal-body">
						<div class="propertyItem form-group">
							<label class="col-xs-3 control-label" localize="audit.filename.label"></label>
							<div class="propertyValue col-xs-9">
								<input type="text" class="form-control"
									 id="csvFilename" maxlength="" name="filename" value="export.csv">
								<div>
									<span class="help-block" localize="audit.filename.info"></span>
								</div>
							</div>
						</div>
						<div id="auditFilterProperties">
							<div class="row">
								<div class="col-xs-12 propertyFilter" id="auditFilterPropertiesPropertyFilter"></div>
							</div>
							<div id="auditFilterPropertiesPanel" class="panel panel-default">
								<div class="panel-heading">
									<h2><i class="fa fa-th"></i><span class="break"></span></h2>
									<ul id="csvPropertiesTabs" class="nav nav-tabs">
										<li class="class_default active csvTab" id="csvPreferencesTab">
											<a class="active auditFilterPropertiesTab" href="#tab-2139007948" name="link_auditFilter.events">
												<span localize="users.exportCSV.preferences.tab"></span>
											</a>
										</li>
										<li class="class_default csvTab" id="csvAttributesTab">
											<a class="auditFilterPropertiesTab" href="#tab-1740160243" name="link_auditFilter.status">
												<span localize="users.exportCSV.attributes.tab"></span>
											</a>
										</li>
									</ul>
								</div>
								<div class="panel-body">
									<div id="csvContent" class="tab-content">
										<div id="csvPreferencesContent" class="tab-pane active">
											<div class="propertyItem form-group class_default">
												<div class="propertyItem form-group">
													<label class="col-xs-3 control-label" localize="audit.outputHeaders.label"></label>
													<div class="propertyValue col-xs-9">
														<div id="csvOutputHeaders" name="csvOutputHeaders"></div>
														<div>
															<span class="help-block" localize="audit.outputHeaders.info"></span>
														</div>
													</div>
												</div>
												<div class="propertyItem form-group">
													<label class="col-xs-3 control-label" localize="audit.delimiter.label"></label>
													<div class="propertyValue col-xs-9">
														<input type="text" class="form-control"
															 id="csvDelimiter" maxlength="" name="delimiter" value=",">
														<div>
															<span class="help-block" localize="audit.delimiter.info"></span>
														</div>
													</div>
												</div>
												<div class="propertyItem form-group">
													<label class="col-xs-3 control-label" localize="audit.terminate.label"></label>
													<div class="propertyValue col-xs-9">
														<div id="csvTerminate"></div>
														<div>
															<span class="help-block" localize="audit.terminate.info"></span>
														</div>
													</div>
												</div>
												<div class="propertyItem form-group">
													<label class="col-xs-3 control-label" localize="audit.wrap.label"></label>
													<div class="propertyValue col-xs-9">
														<input type="text" class="form-control"
															 id="csvWrap" maxlength="" name="wrap" value='"'>
														<div>
															<span class="help-block" localize="audit.wrap.info"></span>
														</div>
													</div>
												</div>
												<div class="propertyItem form-group">
													<label class="col-xs-3 control-label" localize=audit.escape.label></label>
													<div class="propertyValue col-xs-9">
														<input type="text" class="form-control"
															 id="csvEscape" maxlength="" name="escape" value="\">
														<div>
															<span class="help-block" localize="audit.escape.info"></span>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div id="csvAttributesContent" class="tab-pane">
											<label class="col-xs-3 control-label" localize=audit.attributes.label></label>
											<div class="propertyValue col-xs-9">
												<div id="csvAttributes"></div>
												<span class="help-block" localize="audit.attributes.info"></span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<input type="hidden" id="csrfToken" name="token"></input>
					<input type="hidden" id="csvAttributesInput" name="attributes"></input>
					<input type="hidden" id="sortColumn" name="sortColumn"></input>
					<input type="hidden" id="sortOrder" name="sortOrder"></input>
					<input type="hidden" id="searchColumnHidden" name="searchColumn"></input>
					<input type="hidden" id="searchHidden" name="searchPattern"></input>
					<input type="hidden" id="filterHidden" name="filter"></input>
					<input type="hidden" id="outputHeaders" name="outputHeaders"></input>
					<input type="hidden" id="terminateHidden" name="terminate"></input>
					<div class="modal-footer">
						<button id="exportButton" class="btn btn-primary"><i class="fa fa-save"></i><span localize="audit.export.label"></span></button>
					</div>
				</div>
			</div>
		</div>
	</form>
</div>


<div id="contentUsers">
	<div id="userDialog"></div>
	<div id="additionalActions"></div>
	<div id="realmsContent"></div>
</div>

<script type="text/javascript">
	var apiUrl = 'currentRealm';
	$(document).ready(
			function() {
				$('#csrfToken').val(getCsrfToken());

				var disableDecoration = false;
				var buttons = [];

				var ownerRealm;
				var realmName = getAnchorByName('realmName');
				var realmId = getAnchorByName('realmId');
				var realmCategory = getAnchorByName('realmCategory');
				if(!realmCategory) {
					realmCategory = currentRealm.resourceCategory;
				}
				
			    var csvFormUrl = $('#csvForm').attr('action');
				var title = getResource('users.title');

				if(realmId) {
					ownerRealm = true;
					apiUrl = 'ownerRealm/' + realmId;
					disableDecoration = true;
					buttons.push({
						resourceKey: 'backButton',
						buttonClass: 'btn-danger',
						icon: 'fa-step-backward',
						action: function(callback) {
							window.location.hash = "menu=" + getAnchorByName('returnTo');
						}
					});
					title = getResource('ownerRealm.users.title').format(realmName);
				} else {
					realmId = currentRealm.id;	
				}

				buttons.push({
					resourceKey: 'exportToCSV',
					buttonClass: 'btn-primary',
					icon: 'fa-download',
					action: function(callback) {

						$('#csvPreferencesTab').addClass('active');
				   		$('#csvPreferencesContent').addClass('active');
				   		$('#csvAttributesTab').removeClass('active');
				   		$('#csvAttributesContent').removeClass('active');
						$('#exportCSVForm').modal('show');
						$('#csvAttributes').empty().removeData();
						$('#csvAttributesInput').val('');
						$('#csvAttributes').multipleSearchInput({
							nameAttr: 'name',
							valueAttr: 'name',
							isNamePairValue: false,
							nameIsResourceKey: true,
							url: 'currentRealm/attributes',
							changed: function(obj){
								$('#csvAttributesInput').val(obj.getValue().toString());
							}
						});
						$('#csvTerminate').empty().removeData();

						getJSON('realms/eol/', null, function(data){
							var terminateList = [];
							$.each(data.resources, function(index, terminate){
								terminateList.push(terminate);
							});
							$('#csvTerminate').selectButton({
					    			nameAttr: 'name',
					    			valueAttr: 'value',
					    			nameIsResourceKey: false,
					    			changed: function(obj){
					    				$('#terminateHidden').val(obj.getValue());
					    			},
					    			options: terminateList,
					    		});
						});
		        	}
				});

	            $('#exportButton').click(function(){

	            	var opts = $('#contentUsersPlaceholder').bootstrapTable('getOptions');
	            	if(opts) {
	            		$('#sortColumn').val(opts.sortName);
	            		$('#sortOrder').val(opts.sortOrder);
	            	}
	            	var widget = $('#contentUsers').data('callback');
	            	if(widget) {
	            		$('#searchColumnHidden').val(widget.getSearchColumn());
	            		$('#searchHidden').val(widget.getSearch());
	            		$('#filterHidden').val(widget.getFilter());
	            	}
	            
	            	$('#outputHeaders').val($('#csvOutputHeaders').widget().getValue());

					if($('#csvDelimiter').val().length != 1) {
						showError(getResource("users.exportCSV.delimiter.error"));
						return false;
					} else if($('#csvWrap').val().length != 1) {
						showError(getResource("users.exportCSV.wrap.error"));
						return false;
					} else if($('#csvEscape').val().length != 1) {
						showError(getResource("users.exportCSV.escape.error"));
						return false;
					}
					$('#terminateHidden').val($('#csvTerminate').widget().getValue());
					$('#csvForm').find('button.close').click();
	            	$('#csvForm').submit();
			    });

	            $('#csvOutputHeaders').switchInput({
					value: true,
					changed: function(widget) {

					}
				});

			    $('.csvTab').click(function(){
			    	if($(this).attr('id') == 'csvPreferencesTab'){
			    		$('#csvPreferencesTab').addClass('active');
			    		$('#csvPreferencesContent').addClass('active');
			    		$('#csvAttributesTab').removeClass('active');
			    		$('#csvAttributesContent').removeClass('active');
			    	}else{
			    		$('#csvAttributesTab').addClass('active');
			    		$('#csvAttributesContent').addClass('active');
			    		$('#csvPreferencesTab').removeClass('active');
			    		$('#csvPreferencesContent').removeClass('active');
			    	}
			    });

				$(document).data('apiUrl', apiUrl);

				$('#realmsContent').load(uiPath + '/content/realmsDialog.html', function() {

					$('#realmsContent').localize();
					$('#contentExportUsers').localize();

					$('div[dialog-for="realmsContent"]').resourceDialog(
						{ resourceUrl : "realms/realm",
						  resourceKey : 'realm',
						  validate : function() {

							removeMessage();

							if ($('#name').val() == '') {
								showError(getResource("text.nameRequired"));
								return false;
							}

							if(!$('#realmProperties').validateProperties()) {
								showError("error.correctValidationErrors");
								return false;
							}

							return true;
						}, clearDialog : function(create) {
							$('#name').val("");
							$('#name').attr('disabled', false);
							$('#id').val("");
							$('#realmProperties').clearProperties();
							removeMessage();
						}, createResource : function() {
							realm = new Object();
							realm.name = $('#name').val();
							realm.type = $('#typeButton').widget().getValue();
							realm.id = $('#id').val();

							$('#realmProperties').saveProperties(true,
								function(items) {
									realm.properties = items;
							});

							return realm;
						}, confirmed: function(resource, args) {
							if('realm.knownHosts' in resource.properties) {
								var pr = resource.properties['realm.knownHosts'] ;
								if(pr.value.length > 0)
									pr.value += ']|[';
								pr.value += args[3];
							}
							else {
								resource.properties.push(new PropertyItem('realm.knownHosts', args[3]));
							}
						}, resourceUpdated : function(resource) {
							if(currentRealm.resourceCategory === 'local' && resource.type !== 'local') {
								window.location.hash = 'menu=users';
								window.location.reload();
							}
						}, displayResource : function(resource, readOnly) {

							$('#id').val(resource.id);
							$('#name').val(resource.name);

							if(resource.resourceCategory!=='local') {
								$('#typeButton').widget().disable();
							}

							$('#typeButton').widget().setValue(resource.resourceCategory);
							$('#realmProperties').propertyPage(
								{ url : 'realms/realm/properties/' + resource.id,
									showButtons : false,
									useFilters: true,
									resource: resource,
									i18nNamespace: $('#typeButton').widget().getSelectedObject().module,
									displayMode: 'admin,update',
									canUpdate : currentMenu.canUpdate && !readOnly,

							});
						}
					});

				});

				$('#userDialog').load(uiPath + '/content/userDialog.html', function() {

				$('#contentUsers').localize();


				getJSON('menus/tableActions/userActions', null, function(data) {

					var actions = new Array();

					if(data.resources.length > 0) {
						$.each(data.resources, function(idx, action) {
							var div = action.resourceKey + 'Div';
							$('#additionalActions').append('<div id="' + div + '"></div>');
							loadContent('#' + div, uiPath + '/content/' + action.url + '.html');
							actions.push({
								resourceKey : action.resourceKey,
								iconClass : action.iconClass,
								action : function(resource, callback) {
									if($('#' + action.resourceKey).data('action')) {
										$('#' + action.resourceKey).data('action')(resource, callback);
									}
								},
								enabled : true,
								enableFunction: action.enableFunction,
								displayFunction: action.displayFunction
							});
						});
					 }

					var searchFields = [{
						name: 'name'
					}, {
						name: 'description'
					}, {
						name: 'primaryEmail'
					}, {
						name: 'organizationalUnit',
						renderOptions: function(element, refresh) {
							element.autoComplete({
								remoteSearch: false,
								url: apiUrl + '/organizationalUnits',
								nameAttr: 'dn',
								valueAttr: 'dn',
								changed: refresh
							});
						}
					}];

					var fields = [ {
						name : "icon",
						width: 40,
						formatter: function(value, obj, index) {
							return '<div class="center"><i class="fa fa-2x '
							+ getResourceOrDefault(obj.realmModule + '.icon', 'fa-user') + '"></i></div>';
						}
					},{
						name : "name",
						formatter: function(value, obj, index) {
							return '<span data-user-name="' + he.escape(obj.principalName) + '" class="user-detail">' + he.escape(obj.principalName) + '</span>';
						}
					}, {
						name : "description",
						formatter: function(value, obj, index) {
							return he.escape(obj.description);
						},
						class: 'hidden-xs hidden-sm'
					}, {
						name : "primaryEmail",
						class: 'hidden-xs'
					},{
						name : "principalStatus",
						class: 'hidden-xs',
						formatter: function(value, obj, index) {
							if(obj.suspended) {
								return getResource('suspended.label');
							} else {
								return getResource(value + '.label');
							}
						}
					},{
						name : "expires",
						formatter: function(value, obj, index) {
							if(value) {
								return new Date(value).format();
							}
							return null;
						},
						class: 'hidden-xs hidden-sm'
					},{
						name : "lastSignOn",
						formatter: function(value, obj, index) {
							if(value) {
								return new Date(value).format();
							}
							return null;
						},
						class: 'hidden-xs hidden-sm'
					}];

					var searchFilters = [];
					searchFilters.push({name: getResource('all.accounts'), value: '', useDefaultColumns: true, searchColumns: []});
					if(currentRealm.resourceCategory !== 'local') {
						searchFilters.push({name: getResource('local.accounts') , value: 'filter.accounts.local', useDefaultColumns: true, searchColumns: []});
						searchFilters.push({name:  getResource("realm." + currentRealm.resourceCategory + '.accounts') , value: 'filter.accounts.remote', useDefaultColumns: true, searchColumns: []});
					}

					if(ownerRealm) {
						fields.push({
							name: 'parentPrincipal',
							class: 'hidden-xs hidden-sm',
							formatter: function(value, obj, index) {
								if(!obj.parentPrincipal) {
									return null;
								}
								if(obj.parentPrincipal.principalDesc) {
									return he.escape(obj.parentPrincipal.principalDesc);
								}
								return he.escape(obj.parentPrincipal.principalName);
							}
						});
					}

					var resourcePage = $('#contentUsers').ajaxResourcePage(

							{
								id: 'User',
								tableUrl : apiUrl + "/users/table",
								title : title,
								icon : 'fa-user',
								resourceUrl : apiUrl + "/user",
								deleteResourcesUrl : "currentRealm/bulk/users",
								disableDecoration: disableDecoration,
								fields : fields,
								searchColumn: 'name',
								searchFields: searchFields,
								resourceKey : 'user',
								canCreate : currentMenu.canCreate,
								canUpdate : currentMenu.canUpdate,
								canCopy: currentMenu.canUpdate,
								checkReadOnly: false,
								additionalButtons: buttons,
								toolbarButtonsUrl: 'menus/tableActions/usersToolbar',
								canDelete : false,
								detailFormatter: ownerRealm ?
										function(index, resource, $element) {
												$element.extendedResourcePanel({resourceKey: "secondaryTabs",
													resource: resource,
													data: {parentContainer : '#contentUsers'}
							  					});
										}
								: function(index, resource, $element) {
												$element.extendedResourcePanel({resourceKey: "principalTabs",
													resource: resource,
													data: {parentContainer : '#contentUsers'}
										  });
				    	    	},
								additionalActions : actions,
								checkbox : true,
								validate : function(create) {
									if ($('#userName').val().trim() == '') {
										showError("error.nameRequired");
										return false;
									}

									if(!$('#userProperties').validateProperties()) {
										showError("error.correctValidationErrors");
										return false;
									}

									if(create) {
										if($('#userPassword').val().trim() == '') {
											showError("error.passwordEmpty");
											return false;
										}
										if($('#userPassword').val().trim() != $('#userConfirmPassword').val().trim()) {
											showError("error.passwordsNotMatched");
											return false;
										}
									}

									return true;
								},
								clearDialog : function(create) {

									$('#userName').val('');
									$('#userName').attr('disabled', !create),
									$('#userId').val('');
									$('#userPassword').val('');
									$('#userConfirmPassword').val('');
									$('#userProperties').clearProperties();
									$('#tabUserGroups').remove();

									if(create) {
										$('.createOnly').show();
										$('#disableNotifications').prop('checked', true);
										var resourceCategory = currentRealm.resourceCategory;
										if($('#principalType').length > 0) {
											if($('#principalType').widget().getValue() !== '') {
												resourceCategory = $('#principalType').widget().getValue();
											}
										}


										$('#userProperties').parent().append($('#tabPassword').detach());
										$('#tabPassword').removeAttr("style");
										$('#userProperties').empty();

										var tabs = [];
										if(currentRealm.resourceCategory === resourceCategory) {

											$('#userProperties').parent().append('<div id="tabUserGroups"><div id="tabUserGroupsContent" class="col-xs-12"></div></div>');

											$('#tabUserGroupsContent').multipleSearchInput({
												nameAttr : 'principalName',
												disabled: !currentMenu.canUpdate,
												selectedIsObjectList: true,
												valueAttr: 'id',
												searchParams: 'searchColumn=name',
												url: apiUrl + '/groups/table'
											});

											tabs.push({
														id : "tabUserGroups",
														name : getResource("label.groups")
											});
										}

										tabs.push({
												id : "tabPassword",
												name : getResource("label.password")
										});

										$('#passwordPolicy').empty();
										$('#passwordPolicy').passwordPolicy({
											policy: 'default',
											realm: realmId,
											showGenerator: true,
											passwordElement: $('#userPassword'),
											confirmElement: $('#userConfirmPassword'),
											usernameElement: $('#userName')
										});

										if($('#contentUsers').parents('#subMenuPageContent').length > 0) {
											$('#mainContainer').startSpin();
										} else {
											$('#pageContent').startSpin();
										}

										$('#userProperties').propertyPage({
											url : apiUrl + '/user/template/' + realmCategory,
											showButtons : false,
											displayMode: 'admin,create',
											useTemplates : true,
											propertyTabsLast: false,
											urlProcessor: function(url) {
												return url.replace('$' + '{realmApi}', apiUrl);
											},
											i18nNamespace: realmCategory,
											canUpdate : true,
											useFilters: true,
											additionalTabs : tabs,
											complete: function() {
												if(tabs.length > 1) {
													$('#tabPassword').removeAttr("style");
												}

												if($('#contentUsers').parents('#subMenuPageContent').length > 0) {
													$('#mainContainer').stopSpin();
												} else {
													$('#pageContent').stopSpin();
												}

												$('#addUserModal').modal('show');
											}
										});

										return true;
									} else {
										$('.createOnly').hide();
									}
								},
								createResource : function() {

									user = new Object();
									user.id = $('#userId').val().trim();
									user.name = $('#userName').val().trim();
									user.password = $('#userPassword').val().trim();
									user.forceChange = $('#userForceChange').prop('checked') ? true : false;

									$('#userProperties').saveProperties(false,
											function(items) {
												user.properties = items;
											});
									user.groups = $('#tabUserGroupsContent').widget().getValue();

									if(!$('#disableNotifications').prop('checked')) {
										user.properties.push(new PropertyItem('disableNotifications', "true"));
									}
									return user;
								},
								resourceCreated : function(resource) {

								},
								deleted : function(resource) {

								},
								displayResource : function(resource, readOnly, copy) {

									var resourceCategory = currentRealm.resourceCategory;
									if($('#principalType').length > 0) {
										if($('#principalType').widget().getValue() !== '') {
											resourceCategory = $('#principalType').widget().getValue();
										}
									}

									$('#userName').val(resource.name);
									if(copy) {
										$('#userName').attr('disabled', false);
									} else {
										$('#userName').attr('disabled', readOnly || $('#userName').attr('disabled'));
									}
									$('#userId').val(resource.id);

									$('#tabPassword').hide();
									$('#userProperties').parent().append($('#tabPassword').detach());
									
									$('#tabUserGroups').remove();
									$('#userProperties').empty();

									if($('#contentUsers').parents('#subMenuPageContent').length > 0) {
										$('#mainContainer').startSpin();
									} else {
										$('#pageContent').startSpin();
									}

									$('#passwordPolicy').empty();
									$('#passwordPolicy').passwordPolicy({
										policy: 'principal',
										principalId: resource.id,
										showGenerator: true,
										passwordElement: $('#userPassword'),
										confirmElement: $('#userConfirmPassword'),
										usernameElement: $('#userName')
									});

									getJSON(apiUrl + '/groups/user/' + resource.id, null, function(data) {

										var tabs = [];
										if(currentRealm.resourceCategory === resourceCategory) {
											$('#userProperties').parent().append('<div id="tabUserGroups"><div id="tabUserGroupsContent" class="col-xs-12"></div></div>');
											$('#tabUserGroupsContent').multipleSearchInput({
												nameAttr : 'principalName',
												disabled: !currentMenu.canUpdate,
												selectedIsObjectList: true,
												selected : data.resources,
												valueAttr: 'id',
												searchParams: 'searchColumn=name',
												url: "currentRealm/groups/table"
											});

											tabs.push({
														id : "tabUserGroups",
														name : getResource("label.groups")
											});
										}

										if(copy) {
											tabs.push({
													id : "tabPassword",
													name : getResource("label.password")
												});
										}

										


										$('#userProperties').propertyPage({
											url : apiUrl + '/user/properties/' + resource.id,
											showButtons : false,
											displayMode: 'admin,update',
											canUpdate : true,
											propertyTabsLast: false,
											urlProcessor: function(url) {
												return url.replace('$' + '{realmApi}', apiUrl);
											},
											i18nNamespace: realmCategory,
											useFilters: true,
											additionalTabs : tabs,
											complete: function() {
												if(tabs.length > 1) {
													$('#tabPassword').removeAttr("style");
												}

												if($('#contentUsers').parents('#subMenuPageContent').length > 0) {
													$('#mainContainer').stopSpin();
												} else {
													$('#pageContent').stopSpin();
												}

												$('#addUserModal').modal('show');
											}
										});
									});

									return true;
								},
								searchFilters: searchFilters,
								searchFiltersUrl: 'realms/users/filters',
								complete : function() {

									if(currentRealm.resourceCategory !== 'local') {
// 										$('#contentUsers').find('.fixed-table-toolbar').last().append('<div class="tableToolbar pull-right search"><label>Filter:</label><div class="principalType" id="principalType"></div></div>');

// 										var filters = new Array();

// 										filters.push({name: getResource('all.accounts'), value: ''});
// 										filters.push({name: getResource('local.accounts') , value: 'filter.accounts.local'});
// 										filters.push({name:  getResource("realm." + currentRealm.resourceCategory + '.accounts') , value: 'filter.accounts.remote'});

// 										getJSON('realms/users/filters', null, function(data) {

// 											$.each(data.resources, function(idx, obj) {
// 												filters.push({ value: obj, name: getResource(obj)});
// 											});
// 											$('#principalType').textDropdown({
// 												values: filters,
// 												value: '',
// 												changed: function(widget) {
// 													$('.search input[placeholder="Search"]').val('');
// 													resourcePage.refresh();
// 												},
// 												sortOptions: false
// 											});
// 										});
									}

									if(!ownerRealm) {
										var addRealmConfig = function() {
											$('#contentUsers').find('.panel-heading').last().append(
													'<div class="tableToolbar pull-right search"><div><a id="configureUsers" href="#">'
													+ getResource('configure.remote.text') + '</a></div></div>');
											$('#configureUsers').click(function(e) {
												e.preventDefault();
												$('div[dialog-for="realmsContent"]').resourceDialog('edit', currentRealm);
											});					
										};
										if(menuList.realmAdmin)
											addRealmConfig();
										else {
											getJSON('permissions/verify/realm.update', null, function(data) {
												if(data.success) {
													addRealmConfig();								
												}
											});
										}


										/** $('#contentUsers').find('.fixed-table-toolbar').last().append(
												'<div class="tableToolbar pull-right search"><div><a id="resetRealm" href="#">'
												+ getResource('reset.remote.text') + '</a></div></div>');
										$('#resetRealm').click(function(e) {
											e.preventDefault();
											getJSON('realms/reset/' + currentRealm.id, null, function(data) {
												if(data.success) {
													showSuccess(data.message);
												} else {
													showError(data.message);
												}
											});
										}); **/
									}

									loadComplete();
								}
							});

				});

				});

			});
</script>